Generating train split: 884 examples [00:00, 35236.20 examples/s]
Map: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 884/884 [00:00<00:00, 30877.71 examples/s]
Dataset loaded and prepared. First example:
{'messages': [{'content': [{'text': 'You are in factual Q&A competition. Please respond concisely and truthfully in 65 words or less. If you don\'t know the answer, respond with \'I don\'t know\'.\nGiven the context below and the image, answer the question truthfully in one line. Use context to support your answer explicitly. If insufficient information is available, say so.\n\n##Image Caption: The object in the image is a Subaru WRX, which is not designed to transport seven passengers at once.\n##Some Context: [Info 1] Find your perfect Used Subaru WRX STI today &amp; buy your car with confidence. Choose from over 64 cars in stock &amp; find a great deal near you!You can even try and persuade yourself that this performance car is a decent family car, as there’s more than enough room for a couple of passengers in the rear seats, as well as a 460-litre boot behind them, which will swallow plenty of luggage. Certainly, that load capacity is greater than the majority of hot hatchbacks, which the Subaru competes against. The only downside is that it’s not a perfectly square shape, and the restrictive saloon body style means the car isn’t as flexible as rivals such as the VW Golf R or Honda Civic Type R, which have a much wider boot opening and therefore make it much easier to carry wider, taller items with the seats down. Such displays are relatively rare these days, as the market tends to favour rather more subtly styled high-performance models, but the WRX still has some old-school charm which will no doubt endear it to the enthusiasts who are likely to buy it - but probably put off several buyers looking for a fast, discreet mode of family transport. It doesn’t take long for the WRX to reveal its rally-bred roots: the ride is very firm and, at low speeds in particular, it can occasionally be genuinely uncomfortable. Mind you, once you up the pace, the car comes into its own, with better body control. You soon come to appreciate the fact that there’s precious little body roll; and that – combined with the high levels of grip – means you can maintain serious speed through corners. The steering is very light and feels oddly disconnected at first, but you soon realise that it’s nice and quick, getting the car’s nose into bends sharply. The WRX STI’s first line of defence is its four-wheel drive, excellent grip and strong brakes, which can help you avoid trouble in the first place. However, if you are involved in an accident, you’re protected by twin front, side and curtain airbags – as well as one for the driver’s knees – while there are even ISOFIX child seat anchors. Subaru’s Vehicle Dynamics Control system is standard, but drivers who want to use the car on-track can adjust the level of assistance it provides.\n\n[Info 3] The Subaru WRX has long been an affordable performance standard, but the fifth-gen version falls behind some of its competitors. So why do we still like it?The WRX has long been an affordable performance standard, but the fifth-gen version falls behind some of its competitors. So why do we still like it? On the other hand, uphill corning exposes the car\'s heaviness and lack of power. Agility falls a little flat during tight switchbacks, but the quick-ratio steering and AWD traction help keep the WRX composed. I never once found the car to be out of sorts in spirited driving, even on Northern California\'s damp and twisty roads." It\'s easy sometimes to get "too close" to a car, even after only a couple thousand miles, and find yourself overlooking its foibles and taking for granted its strengths. So whenMotorTrendstaff photographer Brandon Lim took a few days off from work to drive 300 miles each way from Los Angeles to San Jose and back, it was a good opportunity to elicit additional feedback about our Subaru WRX Limited. It\'s neither overtly dull nor exceptionally thrilling, it burns fuel quickly (mpg has averaged in the high teens around town, low 20s on road trips, and low teens in the canyons), and it offers plenty of space for passengers and gear. We rather enjoy driving it despite its shortcoming
==((====))==  Unsloth 2025.5.7: Fast Mllama patching. Transformers: 4.51.3. vLLM: 0.8.5.post1.
   \\   /|    NVIDIA GeForce RTX 3090. Num GPUs = 2. Max memory: 23.684 GB. Platform: Linux.
O^O/ \_/ \    Torch: 2.6.0+cu124. CUDA: 8.6. CUDA Toolkit: 12.4. Triton: 3.2.0
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.29.post2. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:06<00:00,  3.40s/it]
Unsloth: Making `model.base_model.model.language_model` require gradients
Starting training...
==((====))==  Unsloth - 2x faster free finetuning | Num GPUs used = 1
   \\   /|    Num examples = 884 | Num Epochs = 3 | Total steps = 9
O^O/ \_/ \    Batch size per device = 64 | Gradient accumulation steps = 4
\        /    Data Parallel GPUs = 1 | Total batch size (64 x 4 x 1) = 256
 "-____-"     Trainable parameters = 52,428,800/11,000,000,000 (0.48% trained)
  0%|                                                                                                                                                                                | 0/9 [00:00<?, ?it/s]Traceback (most recent call last):
  File "/home/dako/Documents/meta_crag_submissions/llama3_new/sft_unsloth.py", line 100, in <module>
  File "/home/dako/miniconda3/envs/crag/lib/python3.12/site-packages/transformers/trainer.py", line 2245, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 269, in _fast_inner_training_loop
  File "/home/dako/miniconda3/envs/crag/lib/python3.12/site-packages/unsloth_zoo/loss_utils.py", line 273, in _unsloth_get_batch_samples
    batch_samples += [next(epoch_iterator)]
                      ^^^^^^^^^^^^^^^^^^^^
  File "/home/dako/miniconda3/envs/crag/lib/python3.12/site-packages/accelerate/data_loader.py", line 566, in __iter__
    current_batch = next(dataloader_iter)
                    ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dako/miniconda3/envs/crag/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 708, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/home/dako/miniconda3/envs/crag/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 764, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dako/miniconda3/envs/crag/lib/python3.12/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dako/miniconda3/envs/crag/lib/python3.12/site-packages/unsloth_zoo/vision_utils.py", line 450, in __call__
    batch = self.processor(
            ^^^^^^^^^^^^^^^
  File "/home/dako/miniconda3/envs/crag/lib/python3.12/site-packages/transformers/models/mllama/processing_mllama.py", line 294, in __call__
    images = make_nested_list_of_images(images)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dako/miniconda3/envs/crag/lib/python3.12/site-packages/transformers/image_utils.py", line 298, in make_nested_list_of_images
    raise ValueError("Invalid input type. Must be a single image, a list of images, or a list of batches of images.")
ValueError: Invalid input type. Must be a single image, a list of images, or a list of batches of images.
Traceback (most recent call last):
  File "/home/dako/Documents/meta_crag_submissions/llama3_new/sft_unsloth.py", line 100, in <module>
  File "/home/dako/miniconda3/envs/crag/lib/python3.12/site-packages/transformers/trainer.py", line 2245, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 269, in _fast_inner_training_loop
  File "/home/dako/miniconda3/envs/crag/lib/python3.12/site-packages/unsloth_zoo/loss_utils.py", line 273, in _unsloth_get_batch_samples
    batch_samples += [next(epoch_iterator)]
                      ^^^^^^^^^^^^^^^^^^^^
  File "/home/dako/miniconda3/envs/crag/lib/python3.12/site-packages/accelerate/data_loader.py", line 566, in __iter__
    current_batch = next(dataloader_iter)
                    ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dako/miniconda3/envs/crag/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 708, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/home/dako/miniconda3/envs/crag/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 764, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dako/miniconda3/envs/crag/lib/python3.12/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/dako/miniconda3/envs/crag/lib/python3.12/site-packages/unsloth_zoo/vision_utils.py", line 450, in __call__
    batch = self.processor(
            ^^^^^^^^^^^^^^^
  File "/home/dako/miniconda3/envs/crag/lib/python3.12/site-packages/transformers/models/mllama/processing_mllama.py", line 294, in __call__
    images = make_nested_list_of_images(images)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dako/miniconda3/envs/crag/lib/python3.12/site-packages/transformers/image_utils.py", line 298, in make_nested_list_of_images
    raise ValueError("Invalid input type. Must be a single image, a list of images, or a list of batches of images.")
ValueError: Invalid input type. Must be a single image, a list of images, or a list of batches of images.
